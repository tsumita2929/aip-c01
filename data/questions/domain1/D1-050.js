window.DOMAIN1_QUESTIONS = window.DOMAIN1_QUESTIONS || [];
window.DOMAIN1_QUESTIONS.push({
  "id": "D1-050",
  "domain": 1,
  "task": "1.5",
  "skill": "1.5.5",
  "type": "single",
  "difficulty": "medium",
  "question": "あるコンサルティング企業が、Amazon Bedrock ナレッジベースを使用した業務分析RAGシステムを運用しています。アナリストが「2024年の売上トップ3の製品と、その製品の顧客満足度スコアを比較して改善提案を作成して」のような複合的なクエリを入力しますが、単一のベクトル検索では売上データと顧客満足度データの両方を網羅する関連チャンクを十分に取得できず、FM の回答が片方のデータに偏る問題が発生しています。この問題を解決するために最も適切なアーキテクチャはどれですか？",
  "options": [
    {
      "id": "A",
      "text": "Bedrock Agents のオーケストレーション機能を使用し、FM がクエリを「2024年の売上トップ3の製品は何か」「各製品の顧客満足度スコアはいくらか」の2つのサブクエリに分解し、それぞれ Bedrock ナレッジベースの Retrieve API で検索して結果を統合した上で、比較分析と改善提案を生成する"
    },
    {
      "id": "B",
      "text": "クエリをそのまま Bedrock ナレッジベースの RetrieveAndGenerate API に送信し、numberOfResults を最大値に設定して取得チャンク数を増やす。FM がコンテキスト内から売上データと満足度データの両方を抽出して回答を生成する"
    },
    {
      "id": "C",
      "text": "Bedrock ナレッジベースのメタデータフィルターで、データ種別を「売上レポート」に限定した検索と「顧客満足度レポート」に限定した検索を同時に実行し、両方の結果を結合して FM に送信する"
    },
    {
      "id": "D",
      "text": "売上データ専用と顧客満足度データ専用の2つの独立したナレッジベースを構築し、Bedrock Agents のマルチナレッジベース検索で両方のナレッジベースから結果を取得して FM に送信する"
    }
  ],
  "correctAnswers": [
    "A"
  ],
  "explanation": "Bedrock Agents のオーケストレーション機能によるクエリ分解は、複合的なクエリを意味的に独立したサブクエリに分割し、それぞれに最適な検索を実行します。「売上トップ3の製品」と「顧客満足度スコア」は異なるドキュメントやセクションに存在する可能性が高く、個別のサブクエリとして検索することで、各トピックに対する関連性スコアの高いチャンクを確実に取得できます。RetrieveAndGenerate + numberOfResults増加（B）は、複合クエリのベクトル表現が売上と満足度の両方のトピックの「平均的な」方向を向くため、どちらのトピックのチャンクも中程度の関連性スコアしか得られず、結果が一方に偏るリスクが残ります。メタデータフィルター（C）はデータ種別による事前絞り込みが可能ですが、2回の検索を手動でオーケストレーションするアプリケーションロジックの実装が必要で、Bedrock Agents のネイティブな分解機能と比較して運用負荷が高くなります。また、メタデータのタグ付けが正確に行われている前提が必要です。2つの独立したナレッジベース（D）はデータの分離により検索精度を向上できますが、ナレッジベースの二重管理（同期スケジュール、埋め込みモデル設定、アクセス制御の各設定が2倍）が必要で、運用負荷が大幅に増加します。（スキル1.5.5）",
  "optionExplanations": {
    "A": {
      "correct": true,
      "text": "正解です。Bedrock Agents によるクエリ分解は、複合クエリを意味的に独立したサブクエリに分割し、各トピックに最適化された検索を実行します。売上データと顧客満足度データの両方を確実に取得でき、結果の偏り問題を根本的に解決します。"
    },
    "B": {
      "correct": false,
      "text": "不正解です。複合クエリのベクトル表現は複数トピックの平均的な方向を向くため、取得チャンク数を増やしても各トピックの関連性スコアが中程度に留まり、結果の偏りという根本原因は解決されません。FM のコンテキストにノイズが増える副作用もあります。"
    },
    "C": {
      "correct": false,
      "text": "不正解です。メタデータフィルターによる2回の検索は技術的に実現可能ですが、検索の分割・実行・結果統合をアプリケーション側で実装する必要があり、Bedrock Agents のネイティブなクエリ分解機能と比較して開発・保守の運用負荷が高くなります。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。2つの独立したナレッジベースの運用は、同期スケジュール・埋め込みモデル設定・アクセス制御の管理が2倍になり、運用負荷が大幅に増加します。単一ナレッジベースでクエリ分解を活用する方が効率的です。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock ナレッジベース",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/knowledge-base.html"
    }
  ]
});
