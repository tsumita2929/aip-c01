window.DOMAIN1_QUESTIONS = window.DOMAIN1_QUESTIONS || [];
window.DOMAIN1_QUESTIONS.push({
  "id": "D1-044",
  "domain": 1,
  "task": "1.5",
  "skill": "1.5.2",
  "type": "single",
  "difficulty": "medium",
  "question": "ある法律事務所が、Amazon Bedrock ナレッジベースと Amazon OpenSearch Service を使用して、判例データベース（1ページの要約文から500ページの詳細判決文まで、文書の長さが大きく異なる10万件のドキュメント）のセマンティック検索システムを構築しています。弁護士が「契約違反における損害賠償の算定基準」のようなクエリを入力した際に、文書の長さに関わらず意味的に最も関連性の高い判例を正確にランキングする必要があります。OpenSearch の k-NN インデックスでベクトル間の距離メトリクスを選択する際、最も適切な構成はどれですか？",
  "options": [
    {
      "id": "A",
      "text": "ユークリッド距離（L2）を距離メトリクスとして設定する。ベクトル空間内の絶対的な距離を測定するため、類似したトピックのドキュメントが空間上で近接してクラスタリングされ、正確な検索結果を得られる"
    },
    {
      "id": "B",
      "text": "コサイン類似度を距離メトリクスとして設定する。ベクトルの方向（角度）のみを比較しノルム（大きさ）の影響を受けないため、文書の長さに起因するベクトルノルムの差異が検索ランキングに影響しない"
    },
    {
      "id": "C",
      "text": "ドット積（内積）を距離メトリクスとして設定する。ベクトルの方向と大きさの両方を考慮するため、長い判決文は情報量が多くスコアが高くなり、包括的な判例を優先的にランキングできる"
    },
    {
      "id": "D",
      "text": "ハミング距離を距離メトリクスとして設定する。バイナリベクトルに変換してからビット単位の差分を計算するため、高次元ベクトルの検索速度が大幅に向上し、10万件規模のデータセットでも低レイテンシーを実現できる"
    }
  ],
  "correctAnswers": [
    "B"
  ],
  "explanation": "コサイン類似度はベクトルの方向（角度）のみを比較し、ベクトルのノルム（大きさ）の影響を受けません。文書の長さが大きく異なるコーパスでは、埋め込みモデルが生成するベクトルのノルムが文書長に影響される場合がありますが、コサイン類似度はこの差を自動的に正規化するため、1ページの要約文と500ページの判決文を意味的な関連性のみで公平にランキングできます。ユークリッド距離（A）はベクトルの絶対的な距離を測定するためノルムの差に影響され、同じトピックでも文書の長さが異なるとベクトル間の距離が大きくなる可能性があります。正規化されていないベクトルでは、短い要約文の方が不当に近い距離と判定される場合があります。ドット積（C）はベクトルの方向と大きさの両方を考慮するため、ノルムの大きい（長い）ドキュメントが不当に高いスコアを得る傾向があります。要件は「意味的に最も関連性の高い判例を正確にランキング」であり、文書の長さでランキングを偏らせることは適切ではありません。ハミング距離（D）はバイナリベクトル（0/1の値のみ）の差分を計算する距離メトリクスであり、埋め込みモデルが生成する連続値の浮動小数点ベクトルには適用できません。検索速度向上のための手法としてはHNSWインデックスのパラメータ最適化が適切です。（スキル1.5.2）",
  "optionExplanations": {
    "A": {
      "correct": false,
      "text": "不正解です。ユークリッド距離はベクトルの絶対的な距離を測定するためノルム（大きさ）の差に影響されます。1ページの要約文と500ページの判決文ではベクトルノルムが異なる可能性があり、同じトピックでも文書長の差異で距離が歪み、意味的関連性による正確なランキングの要件を満たせません。"
    },
    "B": {
      "correct": true,
      "text": "正解です。コサイン類似度はベクトルの方向のみを比較しノルムを自動正規化するため、文書の長さに関わらず意味的な類似性のみでランキングが決定されます。1ページから500ページまで長さが大きく異なる判例データベースでの公平なランキングの要件を直接満たします。"
    },
    "C": {
      "correct": false,
      "text": "不正解です。ドット積はベクトルの方向と大きさの両方を反映するため、ノルムの大きい長文ドキュメントが不当に高いスコアを得る傾向があります。要件は意味的な関連性による正確なランキングであり、文書の長さでスコアが偏ることは不適切です。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。ハミング距離はバイナリベクトル（0/1値）の差分を計算する距離メトリクスであり、埋め込みモデルが生成する連続値の浮動小数点ベクトルには直接適用できません。OpenSearch の k-NN でテキスト埋め込みの類似度検索に使用する距離メトリクスとしては不適切です。"
    }
  },
  "references": [
    {
      "title": "Amazon OpenSearch Service k-NN 検索",
      "url": "https://docs.aws.amazon.com/opensearch-service/latest/developerguide/knn.html"
    }
  ]
});
