window.DOMAIN1_QUESTIONS = window.DOMAIN1_QUESTIONS || [];
window.DOMAIN1_QUESTIONS.push({
  "id": "D1-038",
  "domain": 1,
  "task": "1.4",
  "skill": "1.4.5",
  "type": "multiple",
  "difficulty": "hard",
  "question": "ある製薬企業が、Amazon Bedrock ナレッジベースと OpenSearch Serverless を使用した RAG システムで、臨床試験データや薬事申請文書を管理しています。ドキュメントは日次で新規追加・更新され、S3 バケットに格納されています。要件として、(1) 新規・更新ドキュメントをできるだけ速やかにベクトルストアに反映すること、(2) 埋め込みモデルのバージョンアップ時やチャンキング設定変更時に全ドキュメントの埋め込みを一括で更新できること、(3) データ管理の運用コストを抑えること、が求められています。適切なデータ管理戦略を2つ選択してください。",
  "options": [
    {
      "id": "A",
      "text": "S3 イベント通知で Lambda 関数をトリガーし、新規・更新ドキュメントを検出したら Bedrock ナレッジベースの StartIngestionJob API を呼び出して増分同期を実行する。Lambda はドキュメントのメタデータ検証（ファイル形式、サイズ制限）も行い、不正なファイルの同期をブロックする"
    },
    {
      "id": "B",
      "text": "EventBridge Scheduler で1時間ごとに Bedrock ナレッジベースの StartIngestionJob API を呼び出し、S3 データソースの全ドキュメントに対して定期的にフル同期を実行する。ナレッジベースの同期は差分を検出して変更されたドキュメントのみを再処理する"
    },
    {
      "id": "C",
      "text": "週次の EventBridge スケジュールで Bedrock ナレッジベースのフル同期（全ドキュメントの再ベクトル化）を実行し、増分同期で蓄積された埋め込みの不整合を解消する。埋め込みモデルのバージョンアップ時は即座にフル同期を手動トリガーして全ベクトルを更新する"
    },
    {
      "id": "D",
      "text": "AWS Glue のクローラーを使用して S3 の新規・更新ファイルを検出し、Glue ETL ジョブでドキュメントをチャンキング・前処理した後、Bedrock の InvokeModel API で埋め込みを生成し、OpenSearch Serverless に直接書き込む"
    },
    {
      "id": "E",
      "text": "AWS DataSync を使用してオンプレミスのドキュメント管理システムと S3 を同期し、DataSync のタスク完了通知で SNS 経由で Bedrock ナレッジベースの同期をトリガーする。S3 イベント通知は使用せず、DataSync のスケジュールで同期タイミングを管理する"
    }
  ],
  "correctAnswers": [
    "A",
    "C"
  ],
  "explanation": "A: S3 イベント通知 + Lambda による増分同期は、新規・更新ドキュメントを検出次第すぐにベクトルストアに反映するイベント駆動型のアーキテクチャです。StartIngestionJob API はデータソースの変更を検出して差分のみを処理するため、効率的な増分更新が可能です。Lambda でメタデータ検証を行うことで不正なファイルの同期もブロックできます。C: 週次のフル同期は、増分更新で蓄積される可能性のある不整合（削除されたドキュメントのベクトルが残る等）を解消し、埋め込みの一貫性を保ちます。埋め込みモデルのバージョンアップやチャンキング設定変更時に即座にフル同期を手動トリガーすることで、全ベクトルを新しい設定で一括更新できます。1時間ごとのフル同期（B）は StartIngestionJob が差分検出を行うとはいえ、変更がない時間帯にもAPIを呼び出し続けるためコストが無駄になります。日次で更新が発生する環境では、S3 イベント駆動の方が効率的です。Glue ETL（D）はチャンキング・埋め込み生成・OpenSearch 書き込みのカスタムパイプラインを構築する必要があり、Bedrock ナレッジベースが提供するマネージドなインジェスト機能（自動チャンキング、埋め込み生成、ベクトルストア書き込み）を活用しないため、開発・保守の運用コストが大幅に増加します。DataSync + SNS（E）はオンプレミスとS3の同期には有効ですが、問題文ではドキュメントは既にS3に格納されており、DataSyncの導入は不要な中間レイヤーの追加になります。（スキル1.4.5）",
  "optionExplanations": {
    "A": {
      "correct": true,
      "text": "正解です。S3 イベント通知と Lambda による増分同期は、新規・更新ドキュメントの即時反映をイベント駆動で実現し、StartIngestionJob の差分処理により効率的な更新が可能です。Lambda でのメタデータ検証で不正ファイルのブロックも行えます。"
    },
    "B": {
      "correct": false,
      "text": "不正解です。1時間ごとの定期的なAPI呼び出しは、変更がない時間帯にも実行されるためコストが無駄になります。日次で更新が発生する環境では、S3 イベント駆動の増分同期の方が効率的で、運用コスト削減の要件を満たせません。"
    },
    "C": {
      "correct": true,
      "text": "正解です。週次のフル同期は増分更新で蓄積される不整合を解消し、埋め込みモデルのバージョンアップ時の即時手動トリガーにより全ベクトルの一括更新要件を直接満たします。定期的なフル同期と増分同期の組み合わせがデータ品質を保証します。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。Glue ETL でチャンキング・埋め込み生成・OpenSearch 書き込みのカスタムパイプラインを構築するアプローチは、Bedrock ナレッジベースのマネージドなインジェスト機能を活用しないため、開発・保守コストが大幅に増加し、運用コスト削減の要件を満たせません。"
    },
    "E": {
      "correct": false,
      "text": "不正解です。ドキュメントは既に S3 に格納されているため、DataSync によるオンプレミス同期は不要な中間レイヤーの追加になります。S3 イベント通知で直接トリガーする方がシンプルで運用コストも低くなります。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock ナレッジベースのデータ取り込み",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/knowledge-base-ingest.html"
    },
    {
      "title": "Amazon S3 イベント通知",
      "url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/EventNotifications.html"
    }
  ]
});
