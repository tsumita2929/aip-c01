window.DOMAIN1_QUESTIONS = window.DOMAIN1_QUESTIONS || [];
window.DOMAIN1_QUESTIONS.push({
  "id": "D1-049",
  "domain": 1,
  "task": "1.5",
  "skill": "1.5.5",
  "type": "single",
  "difficulty": "hard",
  "question": "ある小売企業が、Amazon Bedrock ナレッジベースを使用した社内RAGシステムで、営業チーム向けの売上データ検索を提供しています。営業担当者が「先月の売上を教えて」と入力すると、ナレッジベースには月次売上レポートが格納されているにもかかわらず、関連性スコアが低い結果しか返されません。CloudWatch のログを確認したところ、Retrieve API は正常に動作しており、エラーは発生していません。また、「2024年12月の国内売上実績レポート」のように具体的に検索すると正確な結果が返されます。この問題を解決するために最も効果的なアーキテクチャはどれですか？",
  "options": [
    {
      "id": "A",
      "text": "Retrieve API の前段に Lambda 関数を配置し、Bedrock FM でクエリを前処理する。FM が「先月」を具体的な日付範囲（例：2024年12月）に変換し、「売上」を「売上実績レポート」「月次売上サマリ」等の関連用語に拡張してから、変換後のクエリで Retrieve API を呼び出す"
    },
    {
      "id": "B",
      "text": "ナレッジベースのチャンキング戦略をセマンティックチャンキングに変更し、売上レポートの意味的な境界でチャンクを分割する。すべてのドキュメントを再インジェストしてベクトルストアを再構築する"
    },
    {
      "id": "C",
      "text": "Retrieve API の numberOfResults パラメータを現在の5件から20件に増やし、より多くの候補チャンクを取得して FM に送信する。FM がコンテキスト内から最も関連性の高い情報を抽出して回答を生成する"
    },
    {
      "id": "D",
      "text": "埋め込みモデルを現在の Titan Text Embeddings V2（1024次元）から Cohere Embed Multilingual v3 に切り替える。異なるモデルの埋め込み空間が「先月」のような時間表現をより適切にベクトル化し、関連レポートとの類似度が向上する可能性がある"
    }
  ],
  "correctAnswers": [
    "A"
  ],
  "explanation": "具体的なクエリでは正確な結果が返されるため、ベクトルストアのデータ品質や埋め込みモデル自体に問題はありません。問題は「先月」「売上」という曖昧な自然言語クエリの埋め込みベクトルが、「2024年12月の国内売上実績レポート」のような具体的なドキュメントのベクトルとの類似度が低いことにあります。FM によるクエリ拡張（A）は、曖昧な時間表現を具体的な日付に変換し、同義語や関連用語を追加することで、検索クエリのベクトルをドキュメントのベクトルに近づけ、関連性スコアを向上させます。チャンキング戦略の変更（B）はドキュメントの分割方法を改善しますが、クエリ側の曖昧性は解消されず、「先月」と具体的な日付のベクトル距離の問題は残ります。また全ドキュメントの再インジェストに時間とコストがかかります。検索結果数の増加（C）は候補を増やすだけで、上位結果の関連性スコアが低い根本原因は解決しません。低関連性のチャンクが増えることでFMのコンテキストにノイズが混入し、回答精度が低下するリスクもあります。埋め込みモデルの切り替え（D）は全ドキュメントの再ベクトル化が必要で、切り替え後に「先月」のような曖昧な時間表現の処理が改善される保証はありません。問題はモデルの品質ではなくクエリの曖昧性にあります。（スキル1.5.5）",
  "optionExplanations": {
    "A": {
      "correct": true,
      "text": "正解です。FM によるクエリ拡張は、「先月」を具体的な日付範囲に変換し関連用語を追加することで、曖昧なクエリのベクトルをドキュメントのベクトルに近づけ、関連性スコアを向上させます。具体的なクエリでは正常に動作していることから、クエリ側の前処理が最も効果的な解決策です。"
    },
    "B": {
      "correct": false,
      "text": "不正解です。チャンキング戦略の変更はドキュメント側の分割を最適化しますが、クエリ「先月の売上を教えて」の曖昧性は解消されません。具体的なクエリでは正常に検索できていることから、ドキュメント側ではなくクエリ側に問題があるため、チャンキング変更と全ドキュメント再インジェストは不要な工数です。"
    },
    "C": {
      "correct": false,
      "text": "不正解です。検索結果数を増やしても、上位結果の関連性スコアが低い根本原因（曖昧なクエリとドキュメントのベクトル距離）は解決しません。低関連性のチャンクが増えることでFMのコンテキストにノイズが混入し、回答精度が低下するリスクがあります。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。埋め込みモデルの切り替えは全ドキュメントの再ベクトル化が必要で膨大なコストがかかります。具体的なクエリでは現在のモデルで正常に動作していることから、モデルの品質ではなくクエリの曖昧性が問題であり、モデル変更では根本原因を解決できません。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock ナレッジベース",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/knowledge-base.html"
    }
  ]
});
