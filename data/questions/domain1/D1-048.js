window.DOMAIN1_QUESTIONS = window.DOMAIN1_QUESTIONS || [];
window.DOMAIN1_QUESTIONS.push({
  "id": "D1-048",
  "domain": 1,
  "task": "1.5",
  "skill": "1.5.4",
  "type": "multiple",
  "difficulty": "medium",
  "question": "ある保険会社が、Amazon Bedrock ナレッジベースと OpenSearch Serverless を使用した RAG システムで、保険約款や社内規程の検索システムを運用しています。ユーザーから「検索結果に関連性の低いチャンクが混在して回答の精度が低い」というフィードバックを受けています。特に「免責事項の適用条件」のような専門用語を含むクエリでは、セマンティック検索で意味的に類似しているが文脈が異なるチャンクが上位に表示される問題があります。検索精度を改善するために有効なアプローチを2つ選択してください。",
  "options": [
    {
      "id": "A",
      "text": "Bedrock ナレッジベースのリランキング機能を有効化し、Cohere Rerank や Amazon Rerank モデルで初期検索結果（上位50件）をクロスエンコーダーで再スコアリングして、関連性の高い上位5件に絞り込んで FM に送信する"
    },
    {
      "id": "B",
      "text": "Retrieve API の numberOfResults パラメータを最大値（100件）に設定し、取得した全チャンクを FM のコンテキストウィンドウに含めて、FM に関連性の判断を任せる"
    },
    {
      "id": "C",
      "text": "OpenSearch Serverless のハイブリッド検索を活用し、BM25 によるキーワード完全一致検索とベクトル検索を組み合わせて、スコアの正規化と重み付けで「免責事項」等の専門用語の完全一致とセマンティック類似性の両方を考慮したランキングを実現する"
    },
    {
      "id": "D",
      "text": "埋め込みモデルを Titan Text Embeddings V2 から Cohere Embed Multilingual v3 に切り替えて、すべてのドキュメントを再ベクトル化する。異なるモデルのベクトル表現が保険約款の専門用語をより正確に捉える可能性がある"
    },
    {
      "id": "E",
      "text": "Bedrock ナレッジベースのメタデータフィルターで文書カテゴリ（約款/規程/通達）を指定し、検索対象を絞り込む。フィルタリングにより無関係な文書カテゴリのチャンクを排除してノイズを削減する"
    }
  ],
  "correctAnswers": [
    "A",
    "C"
  ],
  "explanation": "A: リランカー（Cohere Rerank/Amazon Rerank）は、初期検索で取得した候補チャンクをクロスエンコーダーモデルでクエリとの関連性を詳細に再評価し、関連性の高い結果を上位に押し上げます。バイエンコーダー（埋め込みモデル）より高精度な関連性判定が可能で、「意味的に類似しているが文脈が異なる」チャンクの除外に効果的です。C: ハイブリッド検索は BM25（キーワード完全一致）とベクトル検索（セマンティック類似性）を組み合わせ、「免責事項」等の専門用語の完全一致スコアとセマンティック類似度の両方をランキングに反映します。専門用語を含むクエリではキーワード一致の重みが効果的に作用します。全チャンクのFM送信（B）は100件のチャンクをコンテキストウィンドウに含めるとトークン数が膨大になり、FM がノイズの多い情報から適切な回答を抽出することが困難になります。また、API のコストも増加します。埋め込みモデルの切り替え（D）は改善の可能性がありますが、全ドキュメントの再ベクトル化に膨大な時間とコストがかかり、切り替え後に精度が向上する保証がありません。メタデータフィルター（E）は検索対象の絞り込みに有効ですが、同一カテゴリ内での関連性ランキングの問題は解決できず、今回の「関連性の低いチャンクの混在」という問題の根本的な解決にはなりません。（スキル1.5.4）",
  "optionExplanations": {
    "A": {
      "correct": true,
      "text": "正解です。リランカーモデルによるクロスエンコーダーベースの再スコアリングは、初期検索結果から関連性の高いチャンクを正確に選別する要件を直接満たします。バイエンコーダーでは区別が困難な「意味的に類似だが文脈が異なる」チャンクの除外に特に効果的です。"
    },
    "B": {
      "correct": false,
      "text": "不正解です。100件のチャンクを FM のコンテキストウィンドウに含めると、トークン数が膨大になりノイズが増加します。FM は関連性の判断ではなく回答生成に最適化されており、大量の低関連性チャンクから正確な情報を抽出することは困難で、コストも増加します。"
    },
    "C": {
      "correct": true,
      "text": "正解です。ハイブリッド検索は BM25 のキーワード完全一致とベクトル検索のセマンティック類似性を組み合わせ、専門用語の正確な一致と意味的な関連性の両方をランキングに反映します。「免責事項の適用条件」のような専門用語を含むクエリで特に効果的です。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。埋め込みモデルの切り替えは検索精度に影響しますが、全ドキュメントの再ベクトル化に膨大な時間・コストがかかり、切り替え後の精度向上が保証されません。リランキングやハイブリッド検索の方が、既存のインフラを活かしながら確実に精度を改善できます。"
    },
    "E": {
      "correct": false,
      "text": "不正解です。メタデータフィルターは無関係な文書カテゴリの排除に有効ですが、同一カテゴリ内での「意味的に類似しているが文脈が異なる」チャンクの混在は解決できません。問題の根本原因はランキングの精度であり、フィルタリングだけでは対処できません。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock ナレッジベースの検索と生成",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/knowledge-base-retrieve.html"
    },
    {
      "title": "Amazon OpenSearch Service k-NN 検索",
      "url": "https://docs.aws.amazon.com/opensearch-service/latest/developerguide/knn.html"
    }
  ]
});
