window.DOMAIN1_QUESTIONS = window.DOMAIN1_QUESTIONS || [];
window.DOMAIN1_QUESTIONS.push({
  "id": "D1-061",
  "domain": 1,
  "task": "1.6",
  "skill": "1.6.6",
  "type": "single",
  "difficulty": "hard",
  "question": "ある SaaS 企業が、カスタマーサポートの問い合わせ対応を自動化するシステムを構築しています。処理フローは「問い合わせの意図分類（FM）→ ナレッジベース検索 → 回答生成（FM）→ 品質チェック（FM による自己評価）」の4ステップで構成されます。要件として、(1) 各ステップで Amazon Bedrock FM を活用すること、(2) 問い合わせの種類（技術サポート/請求/一般質問）に応じて異なるナレッジベースを検索するよう条件分岐すること、(3) 開発チームがプロンプトの変更やフロー構成の修正をコードの変更なしで行えること、が求められています。最も適切なアーキテクチャはどれですか？",
  "options": [
    {
      "id": "A",
      "text": "Bedrock Prompt Flows で4つのステップをノードとして定義する。意図分類ノード（プロンプトノード）の出力に基づき、条件ノードで技術サポート/請求/一般質問の3つのパスに分岐し、各パスで対応するナレッジベースのコレクターノードを配置する。最終ノードで品質チェックプロンプトを実行し、ビジュアルエディタでフロー全体を管理する"
    },
    {
      "id": "B",
      "text": "全4ステップの指示を1つのシステムプロンプトに統合し、Bedrock Converse API で一度のリクエストで処理する。プロンプト内で「まず意図を分類し、次に適切なカテゴリの情報を検索し、回答を生成し、最後に品質を自己評価してください」と段階的に指示する"
    },
    {
      "id": "C",
      "text": "4つの Lambda 関数（意図分類、ナレッジベース検索、回答生成、品質チェック）を開発し、EventBridge Pipes で直列に接続する。各 Lambda 関数内で Bedrock InvokeModel API を呼び出し、環境変数でプロンプトテンプレートを管理する"
    },
    {
      "id": "D",
      "text": "Step Functions のワークフローで4つのステップを Bedrock InvokeModel タスクとして定義し、Choice ステートで問い合わせの種類に応じた分岐を実装する。プロンプトテンプレートはStep Functions の入力パラメータとして定義し、ワークフローの再デプロイで変更を反映する"
    }
  ],
  "correctAnswers": [
    "A"
  ],
  "explanation": "Bedrock Prompt Flows は、複数の FM 呼び出しステップをビジュアルエディタでノードとして連鎖させ、条件分岐を含むプロンプトワークフローを構築する Bedrock ネイティブの機能です。プロンプトの変更やフロー構成の修正をビジュアルエディタから直接行えるため、コード変更なしの要件を満たします。各ノードで異なるFMプロンプトを使用でき、ナレッジベースのコレクターノードで検索も統合できます。全ステップを1つのプロンプトに統合（B）する方法は、FM が4ステップの処理を暗黙的に実行することを期待しますが、ステップごとの入出力の制御（特にナレッジベースの条件分岐検索）ができません。1つのプロンプトでは「技術サポートの場合はナレッジベースAを検索」といった実際のAPI呼び出しの分岐は実行できず、FM が内部で情報を生成するため検索精度が保証されません。Lambda + EventBridge Pipes（C）は機能的には実現可能ですが、4つの Lambda 関数のコード開発・デプロイ・管理が必要で、プロンプトの変更にも Lambda のコードまたは環境変数の更新とデプロイが必要です。コード変更なしで修正を行えるという要件を満たせません。Step Functions（D）はワークフロー制御に優れていますが、プロンプトテンプレートの変更にはStep Functions のワークフロー定義の再デプロイが必要です。Prompt Flows のビジュアルエディタと比較して、プロンプトの変更がコード変更なしで行えるという要件を十分に満たせません。（スキル1.6.6）",
  "optionExplanations": {
    "A": {
      "correct": true,
      "text": "正解です。Bedrock Prompt Flows のビジュアルエディタで4ステップのノード定義、条件分岐、ナレッジベース統合を構成でき、プロンプトの変更やフロー修正をコード変更なしで行えます。Bedrock ネイティブの機能で各ステップのFM活用と条件分岐の要件を直接満たします。"
    },
    "B": {
      "correct": false,
      "text": "不正解です。1つのプロンプトへの統合では、FM が4ステップの処理を暗黙的に実行することを期待しますが、ナレッジベースの実際の検索API呼び出しや条件分岐ができません。FM が検索結果を内部で生成するためハルシネーションのリスクがあり、品質チェックのステップも形式的になります。"
    },
    "C": {
      "correct": false,
      "text": "不正解です。4つの Lambda 関数の開発・管理が必要で、プロンプトの変更には Lambda のコードまたは環境変数の更新とデプロイが必要です。コード変更なしでプロンプトやフロー構成を修正できるという要件を満たせません。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。Step Functions はワークフロー制御に優れていますが、プロンプトテンプレートの変更にワークフロー定義の再デプロイが必要です。Prompt Flows のビジュアルエディタでのプロンプト直接編集と比較して、コード変更なしの運用要件を十分に満たせません。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock Prompt Flows",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/flows.html"
    }
  ]
});
