window.DOMAIN5_QUESTIONS = window.DOMAIN5_QUESTIONS || [];
window.DOMAIN5_QUESTIONS.push({
  "id": "D5-026",
  "domain": 5,
  "task": "5.2",
  "skill": "5.2.2",
  "type": "single",
  "difficulty": "hard",
  "question": "あるフィンテック企業が、Amazon SageMaker リアルタイムエンドポイントで不正取引検知モデルをホスティングしています。デプロイ後にエンドポイントの呼び出しが断続的に ModelError（HTTP 424）を返すようになりました。運用チームが調査したところ、以下の状況が確認されました。\n\n- エンドポイントのヘルスチェック（ping）は正常に応答している\n- CloudWatch の Invocation5XXErrors メトリクスが断続的にスパイクしている\n- エンドポイントの CPU 使用率は平均 30% で安定している\n- メモリ使用率は平均 45% で安定している\n- 直近のデプロイで推論コンテナのモデルサーバーコードに変更があった\n- 同一エンドポイントの以前のバージョンでは正常に動作していた\n\nこの問題の最も可能性の高い根本原因は何ですか？",
  "options": [
    {
      "id": "A",
      "text": "エンドポイントのインスタンスに割り当てられた CPU とメモリのリソースが不足しており、推論処理がタイムアウトしている"
    },
    {
      "id": "B",
      "text": "推論コンテナのモデルサーバーコードの変更にバグがあり、特定の入力パターンで推論処理が例外を発生させている"
    },
    {
      "id": "C",
      "text": "SageMaker エンドポイントの Auto Scaling 設定が適切でなく、トラフィック増加時にインスタンスが不足している"
    },
    {
      "id": "D",
      "text": "モデルアーティファクトが S3 から正しくダウンロードされておらず、推論時にモデルの読み込みに失敗している"
    }
  ],
  "correctAnswers": [
    "B"
  ],
  "explanation": "正解はBです。推論コンテナのモデルサーバーコードの変更にバグがあり、特定の入力パターンで推論処理が例外を発生させていることが、この問題を説明できる唯一の原因です。ModelError（HTTP 424）はコンテナ内の推論コードが例外を返した場合に発生するエラーであり、断続的に発生していることは特定の入力パターンでのみ問題が起きることを示唆しています。直近のデプロイでコードに変更があり、以前のバージョンでは正常だったことも、コード変更に起因する問題を裏付けます。A のリソース不足は CPU 使用率 30%、メモリ使用率 45% という正常な値により排除されます。C の Auto Scaling によるインスタンス不足もリソースメトリクスが安定していることから排除されます。D のモデルアーティファクトのダウンロード失敗であれば、ヘルスチェック（ping）が正常に応答しないはずであり、またすべてのリクエストでエラーが発生するため断続的なエラーパターンとも矛盾します。（スキル5.2.2）",
  "optionExplanations": {
    "A": {
      "correct": false,
      "text": "不正解です。リソース不足であれば CPU やメモリの使用率が高くなるはずですが、CPU 使用率は 30%、メモリ使用率は 45% で安定しており、本文の除外情報と矛盾します。"
    },
    "B": {
      "correct": true,
      "text": "正解です。推論コンテナのコード変更のバグは、ModelError の断続的な発生（特定入力パターンでの例外）を説明できる唯一の原因です。直近のコード変更と以前のバージョンの正常動作により、他の候補は排除されます。"
    },
    "C": {
      "correct": false,
      "text": "不正解です。Auto Scaling によるインスタンス不足であればリソースメトリクスの上昇やスロットリングが見られるはずですが、CPU・メモリ使用率は安定しており、本文の除外情報と矛盾します。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。モデルアーティファクトのダウンロード失敗であれば、ヘルスチェックが失敗しすべてのリクエストでエラーが発生するはずですが、ヘルスチェックは正常でエラーは断続的であり、本文の除外情報と矛盾します。"
    }
  },
  "references": [
    {
      "title": "Amazon SageMaker - エンドポイントのトラブルシューティング",
      "url": "https://docs.aws.amazon.com/sagemaker/latest/dg/endpoint-troubleshooting.html"
    },
    {
      "title": "Amazon SageMaker - 推論コンテナのエラー処理",
      "url": "https://docs.aws.amazon.com/sagemaker/latest/dg/your-algorithms-inference-code.html"
    }
  ]
});
