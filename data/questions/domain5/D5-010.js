window.DOMAIN5_QUESTIONS = window.DOMAIN5_QUESTIONS || [];
window.DOMAIN5_QUESTIONS.push({
  "id": "D5-010",
  "domain": 5,
  "task": "5.1",
  "skill": "5.1.2",
  "type": "single",
  "difficulty": "medium",
  "question": "あるEコマース企業が、商品説明文を生成するAIシステムの新バージョンをデプロイする予定です。現行バージョンからの切り替えリスクを最小化するため、新旧バージョンを並行稼働させて段階的にトラフィックを移行したいと考えています。まず全トラフィックの10%を新バージョンに振り分け、品質指標を監視しながら段階的に100%まで引き上げるデプロイ戦略として最も適切なものはどれですか。",
  "options": [
    {
      "id": "A",
      "text": "ブルー/グリーンデプロイメントを実施し、一度にすべてのトラフィックを新バージョンに切り替える"
    },
    {
      "id": "B",
      "text": "Canary デプロイメントを採用し、Amazon API Gateway のステージ変数とトラフィック分割機能を使用して段階的にトラフィックを移行する"
    },
    {
      "id": "C",
      "text": "Amazon CloudFront のオリジンフェイルオーバーを設定して、新バージョンに障害がある場合のみ旧バージョンにルーティングする"
    },
    {
      "id": "D",
      "text": "Amazon Route 53 のフェイルオーバールーティングポリシーを使用して、ヘルスチェック失敗時にのみ旧バージョンに切り替える"
    }
  ],
  "correctAnswers": [
    "B"
  ],
  "explanation": "正解はBです。Canary デプロイメントは、新バージョンに少量のトラフィック（例：10%）を振り分けて品質指標を監視し、問題がなければ段階的にトラフィック割合を増加させるデプロイ戦略です。API Gateway のステージ変数とCanaryリリース機能を使用することで、正確なトラフィック分割と段階的な移行が可能です。Aは『一度にすべてのトラフィックを切り替える』としているため、段階的な移行（10%から開始して100%まで引き上げる）の要件を満たしません。なお、ブルー/グリーンデプロイメント自体はRoute 53の加重ルーティングと組み合わせることで段階的な移行も可能ですが、選択肢の記述どおりの構成では要件に合致しません。CのCloudFront オリジンフェイルオーバーは高可用性のための機能であり、トラフィック分割による段階的デプロイには対応していません。DのRoute 53のフェイルオーバールーティングは障害検出時の自動切り替えに特化しており、段階的なトラフィック移行には対応していません。（スキル5.1.2）",
  "optionExplanations": {
    "A": {
      "correct": false,
      "text": "不正解です。ブルー/グリーンデプロイメントは環境切り替えには有用であるものの、この選択肢は『一度にすべてのトラフィックを切り替える』としており、10%から段階的に100%まで引き上げるという要件を満たしません。"
    },
    "B": {
      "correct": true,
      "text": "正解です。Canary デプロイメントは、段階的なトラフィック移行と品質指標の監視の両要件を直接満たします。特に API Gateway のステージ変数と Canary リリース機能により、10%から100%への段階的移行を最小の運用負荷で実現できます。"
    },
    "C": {
      "correct": false,
      "text": "不正解です。CloudFront オリジンフェイルオーバーは高可用性のための機能であるものの、トラフィック分割による段階的デプロイには対応していません。段階的な移行の要件を満たせません。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。Route 53 のフェイルオーバールーティングは障害検出時の自動切り替えに特化しているものの、段階的なトラフィック移行（10%→100%）には対応していません。段階的な移行の要件を満たせません。"
    }
  },
  "references": [
    {
      "title": "Amazon API Gateway Canary リリースデプロイメント",
      "url": "https://docs.aws.amazon.com/apigateway/latest/developerguide/canary-release.html"
    },
    {
      "title": "AWS でのデプロイ戦略",
      "url": "https://docs.aws.amazon.com/wellarchitected/latest/machine-learning-lens/mlops.html"
    }
  ]
});
