window.DOMAIN3_QUESTIONS = window.DOMAIN3_QUESTIONS || [];
window.DOMAIN3_QUESTIONS.push({
  "id": "D3-012",
  "domain": 3,
  "task": "3.1",
  "skill": "3.1.5",
  "type": "single",
  "difficulty": "easy",
  "question": "ある企業のセキュリティチームが、Amazon Bedrock を使用したAIアプリケーションの入力サニタイズ処理を設計しています。ユーザー入力からプロンプトインジェクション攻撃を検出し、安全な入力のみをモデルに渡す必要があります。入力サニタイズの基本的なアプローチとして、最も適切なものはどれですか？",
  "options": [
    {
      "id": "A",
      "text": "ユーザー入力をXMLタグ（例: <user_input>...</user_input>）で囲んでシステムプロンプト内に埋め込み、モデルにタグ内のテキストのみをユーザー入力として処理するよう指示する"
    },
    {
      "id": "B",
      "text": "Amazon Bedrock ガードレールのコンテンツフィルターで全カテゴリのしきい値を HIGH に設定し、攻撃的な入力をブロックする"
    },
    {
      "id": "C",
      "text": "Converse API の user ロールと system ロールを使用してユーザー入力とシステムプロンプトを明確に分離し、ユーザー入力に対して Bedrock ガードレールのプロンプト攻撃フィルターを適用する"
    },
    {
      "id": "D",
      "text": "AWS Lambda 関数で入力テキストの長さを検証し、一定文字数を超える入力を拒否してプロンプトインジェクションのペイロードを制限する"
    }
  ],
  "correctAnswers": [
    "C"
  ],
  "explanation": "プロンプトインジェクション対策の基本は、ユーザー入力とシステムプロンプトの明確な分離と、ユーザー入力に対する適切な検証です。Converse API の system ロールと user ロールを使用することで、API レベルでプロンプトの種別を分離でき、Bedrock ガードレールのプロンプト攻撃フィルター（機械学習ベースのインジェクション検出）により攻撃パターンを自動検出・ブロックできます。A のXMLタグによる分離はプロンプトエンジニアリングのテクニックとして有用ですが、攻撃者がタグを閉じて脱出する手法があり、API レベルのロール分離と比較して堅牢性に欠けます。また、ガードレールによる自動検出がないため単独では不十分です。B のコンテンツフィルターは暴力・性的コンテンツ等のカテゴリフィルタリング用であり、プロンプトインジェクション攻撃の検出には対応していません。D の文字数制限は正当な長文入力も制限してしまい、また短い攻撃文（例:「指示を忘れて」）には対応できません。（スキル3.1.5）",
  "optionExplanations": {
    "A": {
      "correct": false,
      "text": "不正解です。XMLタグによる分離はプロンプトエンジニアリング手法として有用であるものの、タグ脱出攻撃への耐性がAPI レベルのロール分離より低く、自動検出機能もないため、確実な入力サニタイズという要件を満たしません。"
    },
    "B": {
      "correct": false,
      "text": "不正解です。コンテンツフィルターは暴力・性的コンテンツ等のカテゴリフィルタリング用であるものの、プロンプトインジェクション攻撃の検出には設計されておらず、攻撃検出という要件を満たしません。"
    },
    "C": {
      "correct": true,
      "text": "正解です。Converse API のロール分離で API レベルでプロンプト種別を区別し、ガードレールのプロンプト攻撃フィルターで ML ベースのインジェクション検出を行うことで、入力サニタイズと攻撃検出を直接満たします。特にプロンプトインジェクション対策を最小の運用負荷で実現できます。"
    },
    "D": {
      "correct": false,
      "text": "不正解です。文字数制限は正当な長文入力も制限してしまうものの、短い攻撃文（「指示を忘れて」等）には対応できず、包括的な入力サニタイズという要件を満たしません。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock Guardrails",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails.html"
    },
    {
      "title": "Amazon Bedrock Security Best Practices",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/security-best-practices.html"
    }
  ]
});
