window.DOMAIN4_QUESTIONS = window.DOMAIN4_QUESTIONS || [];
window.DOMAIN4_QUESTIONS.push({
  "id": "D4-015",
  "domain": 4,
  "task": "4.2",
  "skill": "4.2.1",
  "type": "ordering",
  "difficulty": "hard",
  "question": "ある企業が Amazon Bedrock を使用した RAG ベースのナレッジアシスタントのレイテンシー最適化に取り組んでいます。現在のエンドツーエンドレイテンシーは20秒です。以下の最適化手法を、レイテンシー削減効果が大きい順（最も効果が大きいものから小さいものへ）に並べ替えてください。",
  "options": [
    {
      "id": "A",
      "text": "頻出クエリの検索結果を事前計算してキャッシュに保存する"
    },
    {
      "id": "B",
      "text": "ストリーミングレスポンスを有効化してTTFTを短縮する"
    },
    {
      "id": "C",
      "text": "ベクトル検索とLLM呼び出しの前処理を並列リクエストで実行する"
    },
    {
      "id": "D",
      "text": "レスポンスのログ出力レベルをDEBUGからINFOに変更する"
    }
  ],
  "correctOrder": [
    "A",
    "C",
    "B",
    "D"
  ],
  "explanation": "正しい順序は A → C → B → D です。ここでのレイテンシーとは、エンドツーエンドの処理完了時間（ユーザーがリクエストを送信してから最終レスポンスが完成するまでの時間）を指します。ストリーミングレスポンスはユーザーが最初のトークンを受け取るまでの時間（TTFT）を短縮しますが、全体の処理完了時間には寄与しません。Aの事前計算とキャッシュは、検索とLLM推論の両方をスキップできるため最もレイテンシー削減効果が大きく、キャッシュヒット時はミリ秒単位で応答できます。Cの並列リクエストは、独立した前処理タスクを同時実行することで待ち時間を短縮でき、数秒の改善が期待できます。Bのストリーミングは体感的なTTFTを改善しますが、全体の処理時間自体は変わりません。Dのログレベル変更は微小な改善にとどまります。レイテンシー最適化では、処理をスキップする手法（キャッシュ）> 処理を並列化する手法 > 体感時間を改善する手法 > 微細な調整 の順で効果が大きくなります。（スキル: 4.2.1）",
  "optionExplanations": {
    "A": {
      "correct": true,
      "text": "1番目（最も効果大）: 頻出クエリの検索結果を事前計算してキャッシュに保存することで、キャッシュヒット時は検索と LLM 推論の両方をスキップでき、ミリ秒単位で応答可能になります。処理をスキップする手法として最大のレイテンシー削減効果があります。"
    },
    "C": {
      "correct": true,
      "text": "2番目: ベクトル検索と LLM 呼び出しの前処理を並列リクエストで実行することで、独立したタスクの待ち時間を短縮できます。数秒の改善が期待でき、処理を並列化する手法として効果的です。"
    },
    "B": {
      "correct": true,
      "text": "3番目: ストリーミングレスポンスは体感的な TTFT（最初のトークンまでの時間）を改善しますが、エンドツーエンドの全体処理完了時間自体は変わりません。ユーザー体感としての改善に留まります。"
    },
    "D": {
      "correct": true,
      "text": "4番目（最も効果小）: ログ出力レベルを DEBUG から INFO に変更しても、レイテンシーへの影響は微小です。デバッグログの書き込み量削減による改善はごくわずかです。"
    }
  },
  "references": [
    {
      "title": "Amazon Bedrock のプロンプトキャッシュ",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/prompt-caching.html"
    },
    {
      "title": "Amazon Bedrock ランタイムのストリーミング",
      "url": "https://docs.aws.amazon.com/bedrock/latest/userguide/inference-streaming.html"
    }
  ]
});
